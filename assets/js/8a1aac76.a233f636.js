"use strict";(self.webpackChunkwebsitev_3=self.webpackChunkwebsitev_3||[]).push([[1045],{3905:function(e,r,t){t.d(r,{Zo:function(){return c},kt:function(){return u}});var n=t(7294);function o(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function a(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function s(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?a(Object(t),!0).forEach((function(r){o(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function l(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var i=n.createContext({}),p=function(e){var r=n.useContext(i),t=r;return e&&(t="function"==typeof e?e(r):s(s({},r),e)),t},c=function(e){var r=p(e.components);return n.createElement(i.Provider,{value:r},e.children)},m={inlineCode:"code",wrapper:function(e){var r=e.children;return n.createElement(n.Fragment,{},r)}},d=n.forwardRef((function(e,r){var t=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(t),u=o,v=d["".concat(i,".").concat(u)]||d[u]||m[u]||a;return t?n.createElement(v,s(s({ref:r},c),{},{components:t})):n.createElement(v,s({ref:r},c))}));function u(e,r){var t=arguments,o=r&&r.mdxType;if("string"==typeof e||o){var a=t.length,s=new Array(a);s[0]=d;var l={};for(var i in r)hasOwnProperty.call(r,i)&&(l[i]=r[i]);l.originalType=e,l.mdxType="string"==typeof e?e:o,s[1]=l;for(var p=2;p<a;p++)s[p]=t[p];return n.createElement.apply(null,s)}return n.createElement.apply(null,t)}d.displayName="MDXCreateElement"},1821:function(e,r,t){t.r(r),t.d(r,{assets:function(){return c},contentTitle:function(){return i},default:function(){return u},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return m}});var n=t(7462),o=t(3366),a=(t(7294),t(3905)),s=["components"],l={id:"resolvers",title:"Resolvers",sidebar_label:"Resolvers",sidebar_position:3},i=void 0,p={unversionedId:"basics/resolvers",id:"version-2.x/basics/resolvers",title:"Resolvers",description:"Resolvers in Orionjs are the controllers or main functions to execute routines, query the database and return data with defined structures. These are divided into two large types of resolvers, the resolvers of the application and the resolvers of models. In the case of the resolvers of the application are generally defined to return data with the structures of the database, and the resolvers of models return dynamic information, generally not defined in the schemas of the application.",source:"@site/versioned_docs/version-2.x/basics/resolvers.md",sourceDirName:"basics",slug:"/basics/resolvers",permalink:"/docs/2.x/basics/resolvers",editUrl:"https://github.com/facebook/docusaurus/edit/main/website/docs/basics/resolvers.md",tags:[],version:"2.x",sidebarPosition:3,frontMatter:{id:"resolvers",title:"Resolvers",sidebar_label:"Resolvers",sidebar_position:3},sidebar:"version-2.x/tutorialSidebar",previous:{title:"Models",permalink:"/docs/2.x/basics/models"},next:{title:"Collections",permalink:"/docs/2.x/basics/collections"}},c={},m=[{value:"The structure of the main resolvers of the application",id:"the-structure-of-the-main-resolvers-of-the-application",level:3},{value:"Example of the resolvers directory index",id:"example-of-the-resolvers-directory-index",level:3},{value:"Resolver types",id:"resolver-types",level:2},{value:"Basic resolver",id:"basic-resolver",level:3},{value:"Paginated resolver",id:"paginated-resolver",level:3},{value:"Mutation resolver",id:"mutation-resolver",level:3},{value:"Crud resolver",id:"crud-resolver",level:3},{value:"React App",id:"react-app",level:4},{value:"Orionjs Resolver",id:"orionjs-resolver",level:4},{value:"Model resolver",id:"model-resolver",level:2}],d={toc:m};function u(e){var r=e.components,t=(0,o.Z)(e,s);return(0,a.kt)("wrapper",(0,n.Z)({},d,t,{components:r,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Resolvers in Orionjs are the controllers or main functions to execute routines, query the database and return data with defined structures. These are divided into two large types of resolvers, the resolvers of the application and the resolvers of models. In the case of the resolvers of the application are generally defined to return data with the structures of the database, and the resolvers of models return dynamic information, generally not defined in the schemas of the application."),(0,a.kt)("h3",{id:"the-structure-of-the-main-resolvers-of-the-application"},"The structure of the main resolvers of the application"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"server\n\u2514\u2500\u2500 app\n    \u2514\u2500\u2500 resolvers\n        \u251c\u2500\u2500 ResolverGroup\n        \u2502   \u251c\u2500\u2500 resolver1\n        \u2502   \u2502   \u2514\u2500\u2500 index.js\n        \u2502   \u2514\u2500\u2500 index.js\n        \u2514\u2500\u2500 index.js\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"resolvers"),": The directory of the set of resolvers."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Resolver1"),": Represents the set of resolvers belonging to a specific collection, resolving to the index in charge of importing them all for its call and execution.")),(0,a.kt)("h3",{id:"example-of-the-resolvers-directory-index"},"Example of the resolvers directory index"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import {resolversSchemas} from '@orion-js/graphql'\nimport Resolver1 from './Resolver1'\n\nexport default {\n  ...resolversSchemas,\n  ...Resolver1\n}\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"resolversSchemas")," is responsible for validating both the existence and the correct structure of the imported resolvers, since they can be of type ",(0,a.kt)("a",{parentName:"p",href:"https://orionjs.com/docs/resolvers#basic-resolver"},(0,a.kt)("inlineCode",{parentName:"a"},"Basic Resolver")),", ",(0,a.kt)("a",{parentName:"p",href:"https://orionjs.com/docs/resolvers#mutation"},(0,a.kt)("inlineCode",{parentName:"a"},"mutation")),", ",(0,a.kt)("a",{parentName:"p",href:"https://orionjs.com/docs/resolvers#crud-resolver"},(0,a.kt)("inlineCode",{parentName:"a"},"crudResolver")),", and ",(0,a.kt)("a",{parentName:"p",href:"https://orionjs.com/docs/resolvers#paginated-resolver"},(0,a.kt)("inlineCode",{parentName:"a"},"paginatedResolver")),"."),(0,a.kt)("h2",{id:"resolver-types"},"Resolver types"),(0,a.kt)("h3",{id:"basic-resolver"},"Basic resolver"),(0,a.kt)("p",null,"Basic resolvers are controllers that can receive parameters and use them for a specific calculation, or to make a GraphQL Query to the database to return an element with its defined schema or of some other specific type."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import {resolver} from '@orion-js/app'\nimport Examples from 'app/collections/Examples'\nimport Example from 'app/models/Example'\n\nexport default resolver({\n  params: {\n    parameter1: {\n      type: String\n    }\n  },\n  returns: Example,\n  mutation: false,\n  async resolve({parameter1, parameter2}, viewer) {\n    const response = await Examples.findOne(parameter1)\n    return response\n  }\n})\n")),(0,a.kt)("p",null,"####\xa0Cache\nYou can add cache policy to your resolvers by adding a ",(0,a.kt)("inlineCode",{parentName:"p"},"cache")," property specifying a number of milliseconds:\n",(0,a.kt)("inlineCode",{parentName:"p"},"cache: 1000 * 60 * 60, // Cache 1 hour in milliseconds")),(0,a.kt)("p",null,"####\xa0Permissions\nYou can check if the user perfoming the query or mutation has permission (or any condition) adding a ",(0,a.kt)("inlineCode",{parentName:"p"},"checkPermission")," function to the resolver configuration object."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"This function receives the resolvers ",(0,a.kt)("inlineCode",{parentName:"li"},"parameters")," and the ",(0,a.kt)("inlineCode",{parentName:"li"},"current viwer"),", an object representing the user executing this resolver, as parameters."),(0,a.kt)("li",{parentName:"ul"},"If the user does not have permission or the condition you check is not valid, you should throw an error.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"  ...\n  checkPermission (params, viewer) {\n  // Check permissions or any condition here.\n  // Throw an error if viewer is not allowed or conditions are not met.\n  },\n  ...\n")),(0,a.kt)("h3",{id:"paginated-resolver"},"Paginated resolver"),(0,a.kt)("p",null,"paginatedResolvers are used to get MongoDB cursors for a GraphQL Query, into a paginated list. Notice the ",(0,a.kt)("inlineCode",{parentName:"p"},"async getCursor()")," function with respect to the ",(0,a.kt)("inlineCode",{parentName:"p"},"async resolve()")," function in the ",(0,a.kt)("a",{parentName:"p",href:"https://orionjs.com/docs/resolvers#basic-resolver"},(0,a.kt)("inlineCode",{parentName:"a"},"basicResolver")),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import {paginatedResolver} from '@orion-js/app'\nimport Example from 'app/models/Example'\nimport Examples from 'app/collections/Examples'\n\nexport default paginatedResolver({\n  params: {},\n  returns: Example,\n  async getCursor(params, viewer) {\n    const examples = Examples.find()\n    return examples\n  }\n})\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"paginatedResolvers")," also can receive parameters like in ",(0,a.kt)("inlineCode",{parentName:"p"},"basicResolvers"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import {paginatedResolver} from '@orion-js/app'\nimport Example from 'app/models/Example'\nimport Examples from 'app/collections/Examples'\n\nexport default paginatedResolver({\n  params: {\n    parameter1: {\n      type: String\n    }\n  },\n  returns: Example,\n  async getCursor({parameter1}, viewer) {\n    const examples = Examples.find(parameter1)\n    return examples\n  }\n})\n")),(0,a.kt)("h3",{id:"mutation-resolver"},"Mutation resolver"),(0,a.kt)("p",null,"Mutations are used to perform GraphQL mutations to create, update or delete documents of a collection over the database. notice the ",(0,a.kt)("inlineCode",{parentName:"p"},"mutation: true")," property, which is used to make the distintion for different modules to use, like ",(0,a.kt)("a",{parentName:"p",href:"https://orionjs.com/docs/autoform"},(0,a.kt)("inlineCode",{parentName:"a"},"Autoform"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import {resolver} from '@orion-js/app'\nimport Examples from 'app/collections/Examples'\nimport Example from 'app/models/Example'\n\nexport default resolver({\n  params: {\n    parameter1: {\n      type: String\n    },\n    parameter2: {\n      type: String\n    }\n  },\n  returns: Boolean,\n  mutation: true,\n  async resolve({parameter1, parameter2}, viewer) {\n    const example = await Examples.findOne(parameter1)\n    await example.update({$set: {parameter2: parameter2}})\n    return true\n  }\n})\n")),(0,a.kt)("h3",{id:"crud-resolver"},"Crud resolver"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"crudResolvers")," have the peculiarity of be called from ",(0,a.kt)("inlineCode",{parentName:"p"},"CRUD"),", a React Component created for the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/orionjs/boilerplate-graphql-fullstack"},"Orionjs fullstack Boilerplate"),"."),(0,a.kt)("h4",{id:"react-app"},"React App"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import React from 'react'\nimport Crud from 'App/components/Crud'\n\nexport default class Examples extends React.Component {\n  static propTypes = {}\n\n  getListFields() {\n    return [\n      {title: 'Field 1', name: 'field1'},\n      {title: 'Field 2', name: 'field2'}\n    ]\n  }\n\n  render() {\n    return (\n      <div className={styles.container}>\n        <br />\n        <Crud\n          path=\"/examples\"\n          singular=\"Example\"\n          plural=\"Examples\"\n          allowSearch\n          listFields={this.getListFields()}\n        />\n      </div>\n    )\n  }\n}\n")),(0,a.kt)("h4",{id:"orionjs-resolver"},"Orionjs Resolver"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import {crudResolvers} from '@orion-js/app'\nimport Examples from 'app/collections/Examples'\n\nexport default {\n  ...crudResolvers({\n    collection: Examples,\n    paginatedOptions: {\n      async getCursor({field3}, viewer) {\n        return Examples.find({field3})\n      },\n      params: {\n        field3: {\n          type: String,\n          optional: true\n        }\n      }\n    }\n  })\n}\n")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"model-resolver"},"Model resolver"),(0,a.kt)("p",null,"To learn about Model resolvers, refer to ",(0,a.kt)("a",{parentName:"p",href:"https://orionjs.com/docs/models#resolvers"},(0,a.kt)("inlineCode",{parentName:"a"},"Model resolvers"))))}u.isMDXComponent=!0}}]);