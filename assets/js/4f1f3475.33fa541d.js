"use strict";(self.webpackChunkwebsitev_3=self.webpackChunkwebsitev_3||[]).push([[7628],{3905:function(e,r,n){n.d(r,{Zo:function(){return u},kt:function(){return d}});var t=n(7294);function a(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function o(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function l(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?o(Object(n),!0).forEach((function(r){a(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function s(e,r){if(null==e)return{};var n,t,a=function(e,r){if(null==e)return{};var n,t,a={},o=Object.keys(e);for(t=0;t<o.length;t++)n=o[t],r.indexOf(n)>=0||(a[n]=e[n]);return a}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)n=o[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=t.createContext({}),p=function(e){var r=t.useContext(i),n=r;return e&&(n="function"==typeof e?e(r):l(l({},r),e)),n},u=function(e){var r=p(e.components);return t.createElement(i.Provider,{value:r},e.children)},c={inlineCode:"code",wrapper:function(e){var r=e.children;return t.createElement(t.Fragment,{},r)}},m=t.forwardRef((function(e,r){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),m=p(n),d=a,v=m["".concat(i,".").concat(d)]||m[d]||c[d]||o;return n?t.createElement(v,l(l({ref:r},u),{},{components:n})):t.createElement(v,l({ref:r},u))}));function d(e,r){var n=arguments,a=r&&r.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=m;var s={};for(var i in r)hasOwnProperty.call(r,i)&&(s[i]=r[i]);s.originalType=e,s.mdxType="string"==typeof e?e:a,l[1]=s;for(var p=2;p<o;p++)l[p]=n[p];return t.createElement.apply(null,l)}return t.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8215:function(e,r,n){n.d(r,{Z:function(){return a}});var t=n(7294);function a(e){var r=e.children,n=e.hidden,a=e.className;return t.createElement("div",{role:"tabpanel",hidden:n,className:a},r)}},9877:function(e,r,n){n.d(r,{Z:function(){return u}});var t=n(7462),a=n(7294),o=n(2389),l=n(5979),s=n(6010),i="tabItem_LplD";function p(e){var r,n,o,p=e.lazy,u=e.block,c=e.defaultValue,m=e.values,d=e.groupId,v=e.className,f=a.Children.map(e.children,(function(e){if((0,a.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),h=null!=m?m:f.map((function(e){var r=e.props;return{value:r.value,label:r.label,attributes:r.attributes}})),g=(0,l.lx)(h,(function(e,r){return e.value===r.value}));if(g.length>0)throw new Error('Docusaurus error: Duplicate values "'+g.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var k=null===c?c:null!=(r=null!=c?c:null==(n=f.find((function(e){return e.props.default})))?void 0:n.props.value)?r:null==(o=f[0])?void 0:o.props.value;if(null!==k&&!h.some((function(e){return e.value===k})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+k+'" but none of its children has the corresponding value. Available values are: '+h.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var b=(0,l.UB)(),y=b.tabGroupChoices,N=b.setTabGroupChoices,x=(0,a.useState)(k),w=x[0],E=x[1],C=[],T=(0,l.o5)().blockElementScrollPositionUntilNextRender;if(null!=d){var O=y[d];null!=O&&O!==w&&h.some((function(e){return e.value===O}))&&E(O)}var j=function(e){var r=e.currentTarget,n=C.indexOf(r),t=h[n].value;t!==w&&(T(r),E(t),null!=d&&N(d,t))},I=function(e){var r,n=null;switch(e.key){case"ArrowRight":var t=C.indexOf(e.currentTarget)+1;n=C[t]||C[0];break;case"ArrowLeft":var a=C.indexOf(e.currentTarget)-1;n=C[a]||C[C.length-1]}null==(r=n)||r.focus()};return a.createElement("div",{className:"tabs-container"},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":u},v)},h.map((function(e){var r=e.value,n=e.label,o=e.attributes;return a.createElement("li",(0,t.Z)({role:"tab",tabIndex:w===r?0:-1,"aria-selected":w===r,key:r,ref:function(e){return C.push(e)},onKeyDown:I,onFocus:j,onClick:j},o,{className:(0,s.Z)("tabs__item",i,null==o?void 0:o.className,{"tabs__item--active":w===r})}),null!=n?n:r)}))),p?(0,a.cloneElement)(f.filter((function(e){return e.props.value===w}))[0],{className:"margin-vert--md"}):a.createElement("div",{className:"margin-vert--md"},f.map((function(e,r){return(0,a.cloneElement)(e,{key:r,hidden:e.props.value!==w})}))))}function u(e){var r=(0,o.Z)();return a.createElement(p,(0,t.Z)({key:String(r)},e))}},1953:function(e,r,n){n.r(r),n.d(r,{assets:function(){return m},contentTitle:function(){return u},default:function(){return f},frontMatter:function(){return p},metadata:function(){return c},toc:function(){return d}});var t=n(7462),a=n(3366),o=(n(7294),n(3905)),l=n(9877),s=n(8215),i=["components"],p={id:"resolvers",title:"Resolvers",sidebar_label:"Resolvers",sidebar_position:3},u=void 0,c={unversionedId:"basics/resolvers",id:"basics/resolvers",title:"Resolvers",description:"Resolvers of the application are responsible for handling incoming requests and returning responses to the client.",source:"@site/docs/basics/resolvers.md",sourceDirName:"basics",slug:"/basics/resolvers",permalink:"/docs/basics/resolvers",editUrl:"https://github.com/facebook/docusaurus/edit/main/website/docs/basics/resolvers.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{id:"resolvers",title:"Resolvers",sidebar_label:"Resolvers",sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Models",permalink:"/docs/basics/models"},next:{title:"Collections",permalink:"/docs/basics/collections"}},m={},d=[{value:"Install package",id:"install-package",level:2},{value:"The structure of the main resolvers of the application",id:"the-structure-of-the-main-resolvers-of-the-application",level:3},{value:"Example of the resolvers directory <code>index.ts</code>",id:"example-of-the-resolvers-directory-indexts",level:3},{value:"Resolver types",id:"resolver-types",level:2},{value:"Query resolver",id:"query-resolver",level:3},{value:"Cache",id:"cache",level:4},{value:"Permissions",id:"permissions",level:4},{value:"Mutation resolver",id:"mutation-resolver",level:3},{value:"Paginated resolver",id:"paginated-resolver",level:3},{value:"Install package",id:"install-package-1",level:4}],v={toc:d};function f(e){var r=e.components,p=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,t.Z)({},v,p,{components:r,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Resolvers of the application are responsible for handling incoming requests and returning responses to the client."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Example banner",src:n(3544).Z,width:"1556",height:"822"})),(0,o.kt)("h2",{id:"install-package"},"Install package"),(0,o.kt)(l.Z,{groupId:"npm2yarn",mdxType:"Tabs"},(0,o.kt)(s.Z,{value:"npm",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm install @orion-js/resolvers\n"))),(0,o.kt)(s.Z,{value:"yarn",label:"Yarn",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add @orion-js/resolvers\n")))),(0,o.kt)("h3",{id:"the-structure-of-the-main-resolvers-of-the-application"},"The structure of the main resolvers of the application"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"app\n\u2514\u2500\u2500 resolvers\n    \u251c\u2500\u2500 resolver1\n    \u2502   \u2514\u2500\u2500 index.ts\n    \u251c\u2500\u2500 resolver2\n    \u2502   \u2514\u2500\u2500 index.ts\n    \u2514\u2500\u2500 index.ts\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Folder ",(0,o.kt)("inlineCode",{parentName:"li"},"resolvers"),": The directory of the set of resolvers."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"resolver1")," & ",(0,o.kt)("inlineCode",{parentName:"li"},"resolver2"),": Function to execute routines, query the database and return data with defined structures.")),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"The ",(0,o.kt)("strong",{parentName:"p"},"routing")," mechanism is self-managed by name as you ",(0,o.kt)("strong",{parentName:"p"},"export default")," in the main ",(0,o.kt)("inlineCode",{parentName:"p"},"index.ts")," file in the resolvers folder. For example, if you want to make a query when ",(0,o.kt)("inlineCode",{parentName:"p"},"resolver1")," and the server is running (",(0,o.kt)("a",{parentName:"p",href:"http://localhost:3000/graphiql"},"http://localhost:3000/graphiql"),"), you can send a request through GraphQL as follows:"),(0,o.kt)("pre",{parentName:"div"},(0,o.kt)("code",{parentName:"pre",className:"language-graphql"},"{\n  resolver1\n}\n")))),(0,o.kt)("h3",{id:"example-of-the-resolvers-directory-indexts"},"Example of the resolvers directory ",(0,o.kt)("inlineCode",{parentName:"h3"},"index.ts")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="app/resolvers/index.ts"',title:'"app/resolvers/index.ts"'},"import resolver1 from './resolver1'\nimport resolver2 from './resolver2'\n\nexport default {\n  resolver1,\n  resolver2\n}\n")),(0,o.kt)("h2",{id:"resolver-types"},"Resolver types"),(0,o.kt)("h3",{id:"query-resolver"},"Query resolver"),(0,o.kt)("p",null,"Query resolvers are controllers that can receive parameters and use them for a specific calculation, or to make a GraphQL Query to the database to return an element with its defined schema or of some other specific type."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import {resolver} from '@orion-js/resolvers'\n\nexport default resolver({\n  params: {\n    parameter1: {\n      type: String\n    }\n  },\n  returns: String,\n  async resolve(params, viewer) {\n    return `Hello world, ${params.parameter1}`\n  }\n})\n")),(0,o.kt)("h4",{id:"cache"},"Cache"),(0,o.kt)("p",null,"You can add cache policy to your resolvers by adding a ",(0,o.kt)("inlineCode",{parentName:"p"},"cache")," property specifying a number of milliseconds:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"cache: 1000 * 60 * 60, // Cache 1 hour in milliseconds")),(0,o.kt)("p",null,"Example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import {resolver} from '@orion-js/resolvers'\n\nconst ONE_HOUR_MILLISECONDS = 3600000\n\nexport default resolver({\n  cache: ONE_HOUR_MILLISECONDS,\n  params: {},\n  returns: String,\n  async resolve(params, viewer) {\n    return `Hello Cached`\n  }\n})\n")),(0,o.kt)("h4",{id:"permissions"},"Permissions"),(0,o.kt)("p",null,"You can check if the user perfoming the query or mutation has permission (or any condition) adding a ",(0,o.kt)("inlineCode",{parentName:"p"},"checkPermission")," function to the resolver configuration object."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"This function receives the resolvers ",(0,o.kt)("inlineCode",{parentName:"li"},"parameters")," and the ",(0,o.kt)("inlineCode",{parentName:"li"},"current viwer"),", an object representing the user executing this resolver, as parameters."),(0,o.kt)("li",{parentName:"ul"},"If the user does not have permission or the condition you check is not valid, you should throw an error.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"  ...\n  checkPermission (params, viewer) {\n  // Check permissions or any condition here.\n  // Throw an error if viewer is not allowed or conditions are not met.\n  },\n  ...\n")),(0,o.kt)("h3",{id:"mutation-resolver"},"Mutation resolver"),(0,o.kt)("p",null,"Mutations are used to perform GraphQL mutations to create, update or delete documents of a collection over the database. notice the ",(0,o.kt)("inlineCode",{parentName:"p"},"mutation: true")," property, which is used to make the distintion for different modules to use, like ",(0,o.kt)("a",{parentName:"p",href:"https://orionjs.com/docs/autoform"},(0,o.kt)("inlineCode",{parentName:"a"},"Autoform"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import {resolver} from '@orion-js/resolvers'\nimport Examples from 'app/collections/Examples'\nimport Example from 'app/models/Example'\n\nexport default resolver({\n  params: {\n    parameter1: {\n      type: String\n    },\n    parameter2: {\n      type: String\n    }\n  },\n  returns: Boolean,\n  mutation: true,\n  async resolve({parameter1, parameter2}, viewer) {\n    const example = await Examples.findOne(parameter1)\n    await example.update({$set: {parameter2: parameter2}})\n    return true\n  }\n})\n")),(0,o.kt)("h3",{id:"paginated-resolver"},"Paginated resolver"),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Paginated resolver, required install ",(0,o.kt)("inlineCode",{parentName:"p"},"@orion-js/paginated-mongodb")," package."))),(0,o.kt)("h4",{id:"install-package-1"},"Install package"),(0,o.kt)(l.Z,{groupId:"npm2yarn",mdxType:"Tabs"},(0,o.kt)(s.Z,{value:"npm",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm install @orion-js/paginated-mongodb\n"))),(0,o.kt)(s.Z,{value:"yarn",label:"Yarn",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add @orion-js/paginated-mongodb\n")))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"paginatedResolvers")," are used to get MongoDB cursors for a GraphQL Query, into a paginated list. Notice the ",(0,o.kt)("inlineCode",{parentName:"p"},"async getCursor()")," function with respect to the ",(0,o.kt)("inlineCode",{parentName:"p"},"async resolve()")," function in the ",(0,o.kt)("a",{parentName:"p",href:"/docs/basics/resolvers#basic-resolver"},(0,o.kt)("inlineCode",{parentName:"a"},"basicResolver")),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import {paginatedResolver} from '@orion-js/paginated-mongodb'\nimport Example from 'app/models/Example'\nimport Examples from 'app/collections/Examples'\n\nexport default paginatedResolver({\n  params: {},\n  returns: Example,\n  async getCursor(params, viewer) {\n    return Examples.find()\n  }\n})\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"paginatedResolvers")," also can receive parameters like in ",(0,o.kt)("inlineCode",{parentName:"p"},"resolver"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import {paginatedResolver} from '@orion-js/paginated-mongodb'\nimport Example from 'app/models/Example'\nimport Examples from 'app/collections/Examples'\n\nexport default paginatedResolver({\n  params: {\n    parameter1: {\n      type: String\n    }\n  },\n  returns: Example,\n  async getCursor({parameter1}, viewer) {\n    return Examples.find(parameter1)\n  }\n})\n")))}f.isMDXComponent=!0},3544:function(e,r,n){r.Z=n.p+"assets/images/resolver-application-aa6b45eafcecb04a9703b6199dd43ede.png"}}]);